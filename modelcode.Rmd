---
title: "Model Code"
author: "Nidhi Patel"
date: "4/8/2021"
output: html_document
---

```{r}
library(deSolve)
```

```{r}
HIVTB = function(time, state, parameters) {
  with(as.list(c(state, parameters)), {
    dS = caplambda - (beta*c*S*(I+J3)/N) - lambda*sigma*S*(Jas/R) - mu*S
    dL = beta*c * (S + Tb)*(I+J3)/N - lambda*sigma*L*(Jas/R) - ( mu+k+r1)*L
    dI = k*L - (mu+d+r2)*I
    dTb = r1*L + r2*I - beta*c*Tb*(I+J3)/N - lambda*sigma*Tb*(Jas/R) - mu*Tb
    dJ1 = lambda*sigma*(S+Tb)*(Jas/R) - beta*c*J1*(I+J3)/N - (alpha1 + mu)*J1 + ras*J2
    dJ2 = lambda*sigma*L*(Jas/R) - beta*c*J1*(I+J3)/N - (alpha1 + mu+kas+ras)*J2
    dJ3 = kas*J2 - (alpha3 + mu + das)*J3
    dA = alpha1*J1 + alpha2*J2 + alpha3*J3 - (mu+f)*A
    list(c(dS, dL, dI, dTb, dJ1, dJ2, dJ3, dA))
  })
}
```

Parameters:

**if = 1, we have not found a parameter we like (yet)
```{r}
N = 8336817
L = 1333890.72
J1 = 72300
J2 = 1
J3 = 4700

state = c(
S = N - L - J1 - J2 - J3 ,
L = L,
I = (6.9/100000)*(N),
Tb = 1,
J1 = J1,
J2 = J2,
J3 = J3,
A = 0.166
)

times=1:(365*10)

params = c(
N = N,
R = 1,
Jas = 77000,
caplambda = 1,
beta = 1,
lambda = 1,
c = 1,
sigma = 0.009,
mu = 555.1,
k = 0.09,
kas = 0.1,
d = 0.02,
das = 0.0047,
f = 21.35,
r1 = 70,
r2 = 0.921,
ras =1,
alpha1 = 0.0023,
alpha2 = 0.0023,
alpha3 = 0.0023
)
```


```{r}
sim=ode(y=state,times=times,func=HIVTB,parms=params)
```

